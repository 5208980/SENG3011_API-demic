{% extends "layout.html" %} {% block body %} <div class="row m-0 p-0"><div class="col-lg-4 p-0 overflow-scroll" style="height: 100vh;"> <nav class="navbar navbar-dark sticky-top" style="background-color: #353946;"><h1 class="navbar-brand mb-0 ml-5 text-bold">Covid-Scout</h1> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#n" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon text-white"></span> </button><div class="collapse navbar-collapse" id="n"><div class="navbar-nav"> <a class="nav-item nav-link active text-white" href="{{ url_for('home') }}"><span class="material-icons">home</span></a> <a class="nav-item nav-link text-white" href="{{ url_for('dashboard') }}">Dashboard</a> <a class="nav-item nav-link text-white" href="{{ url_for('latest_news') }}">News</a> <a class="nav-item nav-link text-white" href="{{ url_for('covid19') }}">Global Heatmap</a> <a class="nav-item nav-link text-white" href="{{ url_for('info') }}">Data Centre</a> <a class="nav-item nav-link text-white" href="{{ url_for('au') }}">Australia</a> <a class="nav-item nav-link text-white" href="{{ url_for('about') }}">About</a></div></div> </nav><section class="page-header bg-header"><h2 class="header-content container text-bold" style="padding-left: 2.5em">Covid-19 Live HeatMap</h2> </section><section class="container pb-5"><h4>Advice to prevent getting sick</h4> 1. Wash your hands often <br> 2. Practise social distancing <br> 3. Avoid touching your faces and others <br> 4. Wear mask to limit exposure when going outside <br> 5. If you have sick, stay home and call your doctor <br> 6. Be sure to follow your country's social gathering limitFor more information to protect yourself <a href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/advice-for-public" target="_blank">WHO, Advice for Public</a> <br> https://www.cdc.gov/coronavirus/2019-ncov/faq.html <br> </section><section class="container"><div class="row text-center"><div class="col-sm"><div>Confirmed</div><h4 id="total-confirmed">0</h4></div><div class="col-sm"><div>Deaths</div><h4 id="total-deaths">0</h4></div><div class="col-sm"><div>Recovered</div><h4 id="total-recovered">0</h4></div></div><div class="container p-3"><div class="row"><div class="col text-center"> <button id="displayCases" type="button" class="btn btn-danger">Cases</button> <button id="displayDeaths" type="button" class="btn btn-secondary">Deaths</button></div></div></div> </section><div id="accordion"></div></div><div class="col-lg-8 p-0"><div id="map"></div></div></div> <script src="{{url_for('static', filename='countries.js')}}"></script><script type="text/javascript">let str="{{ data }}",res=str.replace(/&#34;/g,'"');function createDiv(e){let t=document.createElement("div");return t.innerText=`${e}`,t}function createSpan(e){let t=document.createElement("span");return t.innerText=`${e}`,t}function createFlag(e){let t=document.createElement("span");return t.classList.add("flag-icon",`flag-icon-${e}`,"pr-5"),t}function createIcon(e){let t=createSpan(e);return t.classList.add("material-icons"),t}let json=JSON.parse(res),accordion=document.getElementById("accordion"),total={Confirmed:0,Deaths:0,Recovered:0};for(i in json){let e=json[i];total.Confirmed+=e.Confirmed,total.Deaths+=e.Deaths,total.Recovered+=e.Recovered;let t=document.createElement("div");t.classList.add("card","collapsible","collapsible-case");let a=document.createElement("div");a.classList.add("collapse-header","noselect"),a.setAttribute("data-target",`#${e.Code}`),a.setAttribute("data-toggle","collapse"),a.style.background=`${getColor(e.Confirmed)}`;let o=createFlag(json[i].Code.toLowerCase());a.appendChild(o);let n=createSpan(i);a.appendChild(n);let r=createSpan(formatNumber(e.Confirmed));r.classList.add("float-right");let s=createIcon("expand_more");r.appendChild(s),a.appendChild(r),t.appendChild(a);let d=document.createElement("div");d.setAttribute("id",`${e.Code}`),d.classList.add("collapse"),d.setAttribute("data-parent","#accordion");let l=document.createElement("div");l.classList.add("card-body","text-center"),l.innerText=`${formatNumber(e.Confirmed)} Confirmed | ${formatNumber(e.Deaths)} Deaths | ${formatNumber(e.Recovered)} Recovered`,d.appendChild(l),t.appendChild(d),accordion.appendChild(t),(t=document.createElement("div")).classList.add("card","collapsible","collapsible-death"),(a=document.createElement("div")).classList.add("collapse-header","noselect"),a.setAttribute("data-target",`#${e.Code}`),a.setAttribute("data-toggle","collapse"),a.style.background=`${getColor(e.Deaths)}`,o=createFlag(json[i].Code.toLowerCase()),a.appendChild(o),n=createSpan(i),a.appendChild(n),(r=createSpan(formatNumber(e.Deaths))).classList.add("float-right"),s=createIcon("expand_more"),r.appendChild(s),a.appendChild(r),t.appendChild(a),(d=document.createElement("div")).setAttribute("id",`${e.Code}`),d.classList.add("collapse"),d.setAttribute("data-parent","#accordion"),(l=document.createElement("div")).classList.add("card-body","text-center"),l.innerText=`${formatNumber(e.Confirmed)} Confirmed | ${formatNumber(e.Deaths)} Deaths | ${formatNumber(e.Recovered)} Recovered`,d.appendChild(l),t.appendChild(d),accordion.appendChild(t),convertCountry(i)&&(console.log(i),json[convertCountry(i)]=json[i],delete json[i])}function convertCountry(e){return{US:"United States of America",Czechia:"Czech Republic","North Macedonia":"Macedonia","Timor-Leste":"East Timor"}[e]}for(i in document.getElementById("total-confirmed").innerHTML=`${formatNumber(total.Confirmed)}`,document.getElementById("total-deaths").innerHTML=`${formatNumber(total.Deaths)}`,document.getElementById("total-recovered").innerHTML=`${formatNumber(total.Recovered)}`,countriesData.features)name=countriesData.features[i].properties.name,json[name]&&(countriesData.features[i].properties.deaths=json[name].Deaths,countriesData.features[i].properties.confirmed=json[name].Confirmed);var map=L.map("map",{center:[-9.5410977,106.0965923],zoom:3,layers:[L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"Map data &copy; OpenStreetMap contributors"})]}),legend=L.control({position:"bottomright"});legend.onAdd=function(e){var t=L.DomUtil.create("div","legend");return t.innerHTML+='<i style="background: #b10026"></i><span>50,000+</span><br>',t.innerHTML+='<i style="background: #e31a1c"></i><span>10,000-50,000</span><br>',t.innerHTML+='<i style="background: #fc4e2a"></i><span>5,000-10,000</span><br>',t.innerHTML+='<i style="background: #fd8d3c"></i><span>1,000-5,000</span><br>',t.innerHTML+='<i style="background: #feb24c"></i><span>500-1,000</span><br>',t.innerHTML+='<i style="background: #fed976"></i><span>100-500</span><br>',t.innerHTML+='<i style="background: #ffeda0"></i><span>50-100</span><br>',t.innerHTML+='<i style="background: #ffffcc"></i><span>10-50</span><br>',t.innerHTML+='<i style="background: #ebedf0"></i><span>0-10</span><br>',t},legend.addTo(map);var geojson,info=L.control({position:"topright"});function highlightPolygon(e){var t=e.target;t.setStyle({weight:2,color:"#666",dashArray:"",fillOpacity:.7}),t.bringToFront(),info.update(t.feature.properties)}function removeHighlight(e){geojson.resetStyle(e.target),info.update()}function zoomToFeature(e){console.log(e.target.getBounds()),map.flyTo(e.target.getBounds().getCenter(),4),info.update(e.target.feature.properties)}function onEachFeature(e,t){t.on({mouseover:highlightPolygon,mouseout:removeHighlight,click:zoomToFeature})}function styleCases(e){return{fillColor:getColor(e.properties.confirmed),weight:2,opacity:1,color:"white",fillOpacity:.7}}function styleDeaths(e){return{fillColor:getColor(e.properties.deaths),weight:2,opacity:1,color:"white",fillOpacity:.7}}function getColor(e){return e>5e4?"#b10026":e>1e4?"#e31a1c":e>5e3?"#fc4e2a":e>1e3?"#fd8d3c":e>500?"#feb24c":e>100?"#fed976":e>50?"#ffeda0":e>10?"#ffffcc":e<0?"blue":"#ebedf0"}info.onAdd=function(e){return this._div=L.DomUtil.create("div","info"),this.update(),this._div},info.update=function(e){this._div.innerHTML='<h4 class="text-center text-dark">Country Info</h4><div>'+(e?'<div class="text-bold text-center">'+e.name+"</div>"+(e.confirmed?e.confirmed:"0 (Data may be invalid)")+" confirmed cases<br>"+(e.deaths?e.deaths:"0")+" confirmed deaths":'<span class="text-bold text-center">Hover over a country</span>')+"</div>"},info.addTo(map),$(".collapsible-death").hide("slow"),geojson=L.geoJson(countriesData,{style:styleCases,onEachFeature:onEachFeature}).addTo(map),$("#displayDeaths").click(function(){console.log($(this)),$(this).addClass("btn-danger").removeClass("btn-secondary"),$("#displayCases").addClass("btn-secondary").removeClass("btn-danger"),$(".collapsible-case").hide("slow"),$(".collapsible-death").show("slow"),geojson=L.geoJson(countriesData,{style:styleDeaths,onEachFeature:onEachFeature}).addTo(map)}),$("#displayCases").click(function(){$(this).addClass("btn-danger").removeClass("btn-secondary"),$("#displayDeaths").addClass("btn-secondary").removeClass("btn-danger"),$(".collapsible-death").hide("slow"),$(".collapsible-case").show("slow"),geojson=L.geoJson(countriesData,{style:styleCases,onEachFeature:onEachFeature}).addTo(map)});</script> {% endblock %}
